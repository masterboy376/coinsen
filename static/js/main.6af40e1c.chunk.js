(this["webpackJsonptwitter-clone"]=this["webpackJsonptwitter-clone"]||[]).push([[4],{1001:function(t,e){},1017:function(t,e){},1019:function(t,e){},1021:function(t,e){},1151:function(t,e){},1153:function(t,e){},1160:function(t,e){},1161:function(t,e){},1177:function(t,e){},1179:function(t,e){},1187:function(t,e){},1198:function(t,e){},1264:function(t,e,n){"use strict";n.r(e);var s=n(0),r=n.n(s),a=n(270),c=n.n(a),i=(n(630),n(631),n(27)),o=n(10),u=n(34),d=n(1),l=n.n(d),b=(n(373),n(64)),p=n(136),j=n(94),x=n(6),f=function(){var t=Object(s.useState)(0),e=Object(u.a)(t,2),n=e[0],r=e[1],a=Object(s.useState)(0),c=Object(u.a)(a,2),i=c[0],d=c[1],f=Object(s.useState)(0),O=Object(u.a)(f,2),h=O[0],v=O[1],m=Object(s.useState)(0),g=Object(u.a)(m,2),y=g[0],w=g[1],N=Object(j.b)(),P=N.Moralis,S=N.isInitialized,k=Object(s.useState)(),C=Object(u.a)(k,2),A=C[0],F=C[1],T=Object(j.c)(),D=Object(s.useState)(),B=Object(u.a)(D,2),I=B[0],_=B[1],V=Object(j.d)();function E(){return(E=Object(o.a)(l.a.mark((function t(e){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={contractAddress:"0x3b7dcEBA675C5238c8b8a8aBFd8491D36D2bB0B5",functionName:"createProposal",abi:[{inputs:[{internalType:"string",name:"_description",type:"string"},{internalType:"address[]",name:"_canVote",type:"address[]"}],name:"createProposal",outputs:[],stateMutability:"nonpayable",type:"function"}],params:{_description:e,_canVote:y}},t.next=3,V.fetch({params:n,onSuccess:function(){console.log("Proposal Succesful"),_(!1),z()},onError:function(t){alert(t.data.message),_(!1),z()}});case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function W(t){return U.apply(this,arguments)}function U(){return(U=Object(o.a)(l.a.mark((function t(e){var n,s,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=P.Object.extend("ProposalCounts"),(s=new P.Query(n)).equalTo("uid",e),t.next=5,s.first();case 5:if(void 0===(r=t.sent)){t.next=14;break}if(!r.attributes.passed){t.next=11;break}return t.abrupt("return",{color:"green",text:"Passed"});case 11:return t.abrupt("return",{color:"red",text:"Rejected"});case 12:t.next=15;break;case 14:return t.abrupt("return",{color:"blue",text:"Ongoing"});case 15:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function z(){return L.apply(this,arguments)}function L(){return L=Object(o.a)(l.a.mark((function t(){var e,n,s,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=P.Object.extend("Proposals"),(n=new P.Query(e)).descending("uid_decimal"),t.next=5,n.find();case 5:return s=t.sent,t.next=8,Promise.all(s.map(function(){var t=Object(o.a)(l.a.mark((function t(e){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e.attributes.uid,t.t1=e.attributes.description,t.t2=x.jsx,t.t3=p.b,t.t4=e.attributes.description,t.next=7,W(e.attributes.uid);case 7:return t.t5=t.sent.color,t.next=10,W(e.attributes.uid);case 10:return t.t6=t.sent.text,t.t7=e.attributes.uid,t.t8=e.attributes.proposer,t.t9={description:t.t4,color:t.t5,text:t.t6,id:t.t7,proposer:t.t8},t.t10=x.jsx,t.t11=b.h,t.next=18,W(e.attributes.uid);case 18:return t.t12=t.sent.color,t.next=21,W(e.attributes.uid);case 21:return t.t13=t.sent.text,t.t14={color:t.t12,text:t.t13},t.t15=(0,t.t10)(t.t11,t.t14),t.t16={to:"/proposal",state:t.t9,children:t.t15},t.t17=(0,t.t2)(t.t3,t.t16),t.abrupt("return",[t.t0,t.t1,t.t17]);case 27:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 8:r=t.sent,F(r),d(s.length);case 11:case"end":return t.stop()}}),t)}))),L.apply(this,arguments)}function M(){return(M=Object(o.a)(l.a.mark((function t(){var e,n,s,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=P.Object.extend("ProposalCounts"),n=new P.Query(e),t.next=4,n.find();case 4:s=t.sent,a=0,s.forEach((function(t){t.attributes.passed&&a++})),v(s.length),r(a/s.length*100);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var R=function(){var t=Object(o.a)(l.a.mark((function t(){var e,n,s;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={address:"0x2953399124F0cBB46d2CbACD8A89cF0599974963",token_id:"61256219218630090908623884353415804251487165430180099622403610135334702022671",chain:"mumbai"},t.next=3,T.token.getTokenIdOwners(e);case 3:n=t.sent,s=n.result.map((function(t){return t.owner_of})),w(s);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(s.useEffect)((function(){S&&(R(),z(),function(){M.apply(this,arguments)}())}),[S]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("div",{className:"content",children:Object(x.jsx)(b.f,{defaultActiveKey:1,tabStyle:"bulbUnion",children:Object(x.jsx)(b.e,{tabKey:1,tabName:"DAO",children:A&&Object(x.jsxs)("div",{className:"tabContent",children:["Governance Overview",Object(x.jsxs)("div",{className:"widgets",children:[Object(x.jsx)(b.j,{info:i,title:"Proposals Created",style:{width:"200%"},children:Object(x.jsxs)("div",{className:"extraWidgetInfo",children:[Object(x.jsx)("div",{className:"extraTitle",children:"Pass Rate"}),Object(x.jsx)("div",{className:"progress",children:Object(x.jsx)("div",{className:"progressPercentage",style:{width:"".concat(n,"%")}})})]})}),Object(x.jsx)(b.j,{info:y.length,title:"Eligible Voters"}),Object(x.jsx)(b.j,{info:i-h,title:"Ongoing Proposals"})]}),"Recent Proposals",Object(x.jsx)("div",{style:{marginTop:"30px"},children:Object(x.jsx)(b.g,{columnsConfig:"10% 70% 20%",data:A,header:[Object(x.jsx)("span",{style:{textAlign:"center",paddingTop:"14px",margin:"auto"},children:"ID"}),Object(x.jsx)("span",{style:{textAlign:"center",paddingTop:"14px",margin:"auto"},children:"Description"}),Object(x.jsx)("span",{style:{textAlign:"center",paddingTop:"14px",margin:"auto"},children:"Status"})],pageSize:3})}),Object(x.jsx)(b.c,{buttonConfig:{isLoading:I,loadingText:"Submitting Proposal",text:"Submit",theme:"secondary"},data:[{inputWidth:"100%",name:"New Proposal",type:"textarea",validation:{required:!0},value:""}],onSubmit:function(t){_(!0),function(t){E.apply(this,arguments)}(t.data[0].inputResult)},title:"Create a New Proposal"})]})})})}),Object(x.jsx)("div",{className:"voting"})]})},O=function(){var t=Object(i.e)().state,e=Object(j.b)(),n=e.Moralis,r=e.isInitialized,a=Object(s.useState)(),c=Object(u.a)(a,2),d=c[0],f=c[1],O=Object(s.useState)(0),h=Object(u.a)(O,2),v=h[0],m=h[1],g=Object(s.useState)(0),y=Object(u.a)(g,2),w=y[0],N=y[1],P=Object(s.useState)([]),S=Object(u.a)(P,2),k=S[0],C=S[1],A=Object(s.useState)(!1),F=Object(u.a)(A,2),T=F[0],D=F[1],B=Object(j.d)();function I(t){return _.apply(this,arguments)}function _(){return(_=Object(o.a)(l.a.mark((function e(n){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={contractAddress:"0x3b7dcEBA675C5238c8b8a8aBFd8491D36D2bB0B5",functionName:"voteOnProposal",abi:[{inputs:[{internalType:"uint256",name:"_id",type:"uint256"},{internalType:"bool",name:"_vote",type:"bool"}],name:"voteOnProposal",outputs:[],stateMutability:"nonpayable",type:"function"}],params:{_id:t.id,_vote:n}},e.next=3,B.fetch({params:s,onSuccess:function(){console.log("Vote Cast Succesfully"),D(!1)},onError:function(t){alert(t.data.message),D(!1)}});case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){if(r){var e=function(){var e=Object(o.a)(l.a.mark((function e(){var s,r,a,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.Object.extend("Votes"),(r=new n.Query(s)).equalTo("proposal",t.id),r.descending("createdAt"),e.next=6,r.find();case 6:(a=e.sent).length>0&&(f(a[0].attributes),N((Number(a[0].attributes.votesDown)/(Number(a[0].attributes.votesDown)+Number(a[0].attributes.votesUp))*100).toFixed(0)),m((Number(a[0].attributes.votesUp)/(Number(a[0].attributes.votesDown)+Number(a[0].attributes.votesUp))*100).toFixed(0))),c=a.map((function(t){return[t.attributes.voter,Object(x.jsx)(b.d,{fill:t.attributes.votedFor?"#2cc40a":"#d93d3d",size:24,svg:t.attributes.votedFor?"checkmark":"arrowCircleDown"})]})),C(c);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}}),[r]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"contentProposal",children:[Object(x.jsxs)("div",{className:"proposal",children:[Object(x.jsx)(p.b,{to:"/",children:Object(x.jsxs)("div",{className:"backHome",children:[Object(x.jsx)(b.d,{fill:"#ffffff",size:20,svg:"chevronLeft"}),"Overview"]})}),Object(x.jsx)("div",{children:t.description}),Object(x.jsxs)("div",{className:"proposalOverview",children:[Object(x.jsx)(b.h,{color:t.color,text:t.text}),Object(x.jsxs)("div",{className:"proposer",children:[Object(x.jsx)("span",{children:"Proposed By "}),Object(x.jsx)(b.i,{content:t.proposer,children:Object(x.jsx)(b.a,{seed:t.proposer})})]})]})]}),d&&Object(x.jsxs)("div",{className:"widgets",children:[Object(x.jsx)(b.j,{info:d.votesUp,title:"Votes For",children:Object(x.jsxs)("div",{className:"extraWidgetInfo",children:[Object(x.jsxs)("div",{className:"extraTitle",children:[v,"%"]}),Object(x.jsx)("div",{className:"progress",children:Object(x.jsx)("div",{className:"progressPercentage",style:{width:"".concat(v,"%")}})})]})}),Object(x.jsx)(b.j,{info:d.votesDown,title:"Votes Against",children:Object(x.jsxs)("div",{className:"extraWidgetInfo",children:[Object(x.jsxs)("div",{className:"extraTitle",children:[w,"%"]}),Object(x.jsx)("div",{className:"progress",children:Object(x.jsx)("div",{className:"progressPercentage",style:{width:"".concat(w,"%")}})})]})})]}),Object(x.jsx)(b.g,{style:{width:"100%"},columnsConfig:"90% 10%",data:k,header:[Object(x.jsx)("span",{style:{padding:"10px"},children:"Address"}),Object(x.jsx)("span",{style:{padding:"10px"},children:"Vote"})],pageSize:5}),Object(x.jsx)(b.c,{isDisabled:"Ongoing"!==t.text,style:{backgroundColor:"black",width:"auto",height:"250px",border:"1px solid rgba(6, 158, 252, 0.2)"},buttonConfig:{isLoading:T,loadingText:"Casting Vote",text:"Vote",theme:"secondary"},data:[{inputWidth:"100%",name:"Cast Vote",options:["For","Against"],type:"radios",validation:{required:!0}}],onSubmit:function(t){"For"===t.data[0].inputResult[0]?I(!0):I(!1),D(!0)},title:"Cast Vote"})]}),Object(x.jsx)("div",{className:"voting"})]})},h=function(){return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"header",children:[Object(x.jsx)("span",{style:{fontSize:"25px",fontWeight:"bold",color:"white"},children:"DAO"}),Object(x.jsx)(b.b,{})]}),Object(x.jsxs)(i.c,{children:[Object(x.jsx)(i.a,{path:"/",element:Object(x.jsx)(f,{})}),Object(x.jsx)(i.a,{path:"/proposal",element:Object(x.jsx)(O,{})})]})]})},v=function(t){t&&t instanceof Function&&n.e(18).then(n.bind(null,1529)).then((function(e){var n=e.getCLS,s=e.getFID,r=e.getFCP,a=e.getLCP,c=e.getTTFB;n(t),s(t),r(t),a(t),c(t)}))};c.a.render(Object(x.jsx)(r.a.StrictMode,{children:Object(x.jsx)(j.a,{appId:"xsIWcyAhhAAtQWbld9yWG4JPIvlG6IPrLyR5epje",serverUrl:"https://gux2pjdgfkp9.usemoralis.com:2053/server",children:Object(x.jsx)(p.a,{children:Object(x.jsx)(h,{})})})}),document.getElementById("root")),v()},373:function(t,e,n){},534:function(t,e){function n(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id=534},630:function(t,e,n){},631:function(t,e,n){},896:function(t,e){},925:function(t,e){},965:function(t,e){},967:function(t,e){},987:function(t,e){},989:function(t,e){}},[[1264,5,6]]]);
//# sourceMappingURL=main.6af40e1c.chunk.js.map